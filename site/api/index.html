<!-- Version warning -->
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Wiki for Sapsan: ML-based turbulence modeling for astrophysics" name="description"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.3.1, mkdocs-material-8.4.1" name="generator"/>
<title>API Reference - Sapsan Wiki</title>
<link href="../assets/stylesheets/main.69437709.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Noto Sans";--md-code-font:"JetBrains Mono"}</style>
<link href="../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>html.glightbox-open { overflow: initial; height: 100%; }</style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="red" data-md-color-primary="red" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#api-reference">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-component="outdated" hidden="">
<aside class="md-banner md-banner--warning">
<div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
<strong>Click here to go to latest.</strong>
</a>
</div>
<script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
</aside>
</div>
<header class="md-header md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Sapsan Wiki" class="md-header__button md-logo" data-md-component="logo" href=".." title="Sapsan Wiki">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Sapsan Wiki
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              API Reference
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="red" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="red" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/pikarpov-LANL/Sapsan" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Sapsan
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
        Home
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="./">
        API Reference
      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden="">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Sapsan Wiki" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Sapsan Wiki">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Sapsan Wiki
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/pikarpov-LANL/Sapsan" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Sapsan
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Home" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Home
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Welcome to Sapsan!
      </a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2">
          Overview
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Overview" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
          Overview
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../overview/installation/">
        Installation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../overview/getting_started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_3" id="__nav_1_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_3">
          Examples
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Examples" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_3">
<span class="md-nav__icon md-icon"></span>
          Examples
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../overview/examples/local_examples/">
        Built-in Examples
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../overview/examples/web_examples/">
        Online Examples
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Tutorials" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/custom_estimator/">
        Custom Estimator
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/custom_docker/">
        Custom Docker
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/model_graph/">
        Model Graph
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/mlflow/">
        MLflow Tracking
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/savenload/">
        Save &amp; Load Models
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/parallelgpu/">
        Parallel GPU Training
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4">
          Technical Details
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Technical Details" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
          Technical Details
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../details/estimators/">
        Estimators
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../details/structure/">
        Structure
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" id="__nav_1_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_5">
          Other
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Other" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_5">
<span class="md-nav__icon md-icon"></span>
          Other
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../other/community/">
        Community Guidelines
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          API Reference
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="API Reference" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          API Reference
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        API Reference
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#glossary">
    Glossary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trainevaluate">
    Train/Evaluate
  </a>
<nav aria-label="Train/Evaluate" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#train">
    Train
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#evaluate">
    Evaluate
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#estimators">
    Estimators
  </a>
<nav aria-label="Estimators" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cnn3d">
    CNN3d
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pimlturb">
    PIMLTurb
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#picae">
    PICAE
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#krr">
    KRR
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#load_estimator">
    load_estimator
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#load_sklearn_estimator">
    load_sklearn_estimator
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torch-modules">
    Torch Modules
  </a>
<nav aria-label="Torch Modules" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#gaussian">
    Gaussian
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interp1d">
    Interp1d
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-loaders">
    Data Loaders
  </a>
<nav aria-label="Data Loaders" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hdf5dataset">
    HDF5Dataset
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get_loader_shape">
    get_loader_shape
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-manipulation">
    Data Manipulation
  </a>
<nav aria-label="Data Manipulation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#equidistantsampling">
    EquidistantSampling
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#split_data_by_batch">
    split_data_by_batch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#combine_data">
    combine_data
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#slice_of_cube">
    slice_of_cube
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#filter">
    Filter
  </a>
<nav aria-label="Filter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#spectral">
    spectral
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#box">
    box
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gaussian_1">
    gaussian
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backend-tracking">
    Backend (Tracking)
  </a>
<nav aria-label="Backend (Tracking)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mlflowbackend">
    MLflowBackend
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fakebackend">
    FakeBackend
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#plotting">
    Plotting
  </a>
<nav aria-label="Plotting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#plot_params">
    plot_params
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pdf_plot">
    pdf_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cdf_plot">
    cdf_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#line_plot">
    line_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#slice_plot">
    slice_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log_plot">
    log_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#model_graph">
    model_graph
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#physics">
    Physics
  </a>
<nav aria-label="Physics" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#reynoldsstress">
    ReynoldsStress
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#powerspectrum">
    PowerSpectrum
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gradientmodel">
    GradientModel
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamicsmagorinskymodel">
    DynamicSmagorinskyModel
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#glossary">
    Glossary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trainevaluate">
    Train/Evaluate
  </a>
<nav aria-label="Train/Evaluate" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#train">
    Train
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#evaluate">
    Evaluate
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#estimators">
    Estimators
  </a>
<nav aria-label="Estimators" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cnn3d">
    CNN3d
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pimlturb">
    PIMLTurb
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#picae">
    PICAE
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#krr">
    KRR
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#load_estimator">
    load_estimator
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#load_sklearn_estimator">
    load_sklearn_estimator
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torch-modules">
    Torch Modules
  </a>
<nav aria-label="Torch Modules" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#gaussian">
    Gaussian
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interp1d">
    Interp1d
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-loaders">
    Data Loaders
  </a>
<nav aria-label="Data Loaders" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hdf5dataset">
    HDF5Dataset
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get_loader_shape">
    get_loader_shape
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-manipulation">
    Data Manipulation
  </a>
<nav aria-label="Data Manipulation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#equidistantsampling">
    EquidistantSampling
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#split_data_by_batch">
    split_data_by_batch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#combine_data">
    combine_data
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#slice_of_cube">
    slice_of_cube
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#filter">
    Filter
  </a>
<nav aria-label="Filter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#spectral">
    spectral
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#box">
    box
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gaussian_1">
    gaussian
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backend-tracking">
    Backend (Tracking)
  </a>
<nav aria-label="Backend (Tracking)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mlflowbackend">
    MLflowBackend
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fakebackend">
    FakeBackend
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#plotting">
    Plotting
  </a>
<nav aria-label="Plotting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#plot_params">
    plot_params
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pdf_plot">
    pdf_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cdf_plot">
    cdf_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#line_plot">
    line_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#slice_plot">
    slice_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log_plot">
    log_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#model_graph">
    model_graph
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#physics">
    Physics
  </a>
<nav aria-label="Physics" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#reynoldsstress">
    ReynoldsStress
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#powerspectrum">
    PowerSpectrum
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gradientmodel">
    GradientModel
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamicsmagorinskymodel">
    DynamicSmagorinskyModel
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/pikarpov-LANL/Sapsan/edit/master/docs/api.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1 id="api-reference">API Reference</h1>
<h2 id="glossary">Glossary</h2>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>N</td>
<td># of Batches</td>
</tr>
<tr>
<td>C<sub>in</sub></td>
<td># of input channels (i.e. features)</td>
</tr>
<tr>
<td>D or D<sub>b</sub></td>
<td>Data or Batch depth (z)</td>
</tr>
<tr>
<td>H or H<sub>b</sub></td>
<td>Data or Batch height (y)</td>
</tr>
<tr>
<td>W or W<sub>b</sub></td>
<td>Data or Batch width (x)</td>
</tr>
</tbody>
</table>
<h2 id="trainevaluate">Train/Evaluate</h2>
<hr/>
<h3 id="train">Train</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.experiments.train.Train</code><em><code>(model: Estimator, data_parameters: dict, backend = FakeBackend(), show_log = True, run_name = 'train')</code></em></p>
</div>
<dl>
<dd>Call <code>Train</code> to set up your run    </dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td>object</td>
<td>model to use for training</td>
<td></td>
</tr>
<tr>
<td><nobr><code>data_parameters</code></nobr></td>
<td>dict</td>
<td>data parameters from the data loader, necessary for tracking</td>
<td></td>
</tr>
<tr>
<td><code>backend</code></td>
<td>object</td>
<td>backend to track the experiment</td>
<td>FakeBackend()</td>
</tr>
<tr>
<td><code>show_log</code></td>
<td>bool</td>
<td>show the loss vs. epoch progress plot (it will be save in mlflow in either case)</td>
<td>True</td>
</tr>
<tr>
<td><code>run_name</code></td>
<td>str</td>
<td>'run name' tag as recorded under MLflow</td>
<td>train</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.experiments.train.Train.run()</code></p>
</div>
<dl>
<dd>Run the model</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pytorch or sklearn or custom type</td>
<td>trained model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="evaluate">Evaluate</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.experiments.evaluate.Evaluate</code><em><code>(model: Estimator, data_parameters: dict, backend = FakeBackend(), cmap: str = 'plasma', run_name: str = 'evaluate', **kwargs)</code></em></p>
</div>
<dl>
<dd>Call <code>Evaluate</code> to set up the testing of the trained model. Don't forget to update <code>estimator.loaders</code> with the new data for testing.</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td>object</td>
<td>model to use for testing</td>
<td></td>
</tr>
<tr>
<td><nobr><code>data_parameters</code></nobr></td>
<td>dict</td>
<td>data parameters from the data loader, necessary for tracking</td>
<td></td>
</tr>
<tr>
<td><code>backend</code></td>
<td>obejct</td>
<td>backend to track the experiment</td>
<td>FakeBackend()</td>
</tr>
<tr>
<td><code>cmap</code></td>
<td>str</td>
<td>matplotlib colormap to use for slice plots</td>
<td>plasma</td>
</tr>
<tr>
<td><code>run_name</code></td>
<td>str</td>
<td>'run name' tag as recorded under MLflow</td>
<td>evaluate</td>
</tr>
<tr>
<td><code>pdf_xlim</code></td>
<td>tuple</td>
<td>x-axis limits for the PDF plot</td>
<td></td>
</tr>
<tr>
<td><code>pdf_ylim</code></td>
<td>tuple</td>
<td>y-axis limits for the PDF plot</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.experiments.evaluate.Evaluate.run()</code></p>
</div>
<dl>
<dd>Run the evaluation of the trained model</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dict{'target' : np.ndarray, 'predict' : np.ndarray}</td>
<td>target and predicted data</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="estimators">Estimators</h2>
<hr/>
<h3 id="cnn3d">CNN3d</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.CNN3d</code><em><code>(loaders, config, model)</code></em></p>
</div>
<dl>
<dd>A model based on Pytorch's <a href="/details/estimators/#convolution-neural-network-cnn">3D Convolutional Neural Network</a></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>loaders</code></td>
<td>dict</td>
<td>contains input and target data (loaders['train'], loaders['valid']). Datasets themselves have to be torch.tensor(s)</td>
<td>CNN3dConfig()</td>
</tr>
<tr>
<td><code>config</code></td>
<td>class</td>
<td>configuration to use for the model</td>
<td>CNN3dConfig()</td>
</tr>
<tr>
<td><code>model</code></td>
<td>class</td>
<td>the model itself - should not be adjusted</td>
<td>CNN3dModel()</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.CNN3d.save</code><em><code>(path: str)</code></em></p>
</div>
<dl>
<dd>Saves model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.CNN3d.load</code><em><code>(path: str, estimator, load_saved_config = False)</code></em></p>
</div>
<dl>
<dd>Loads model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
<tr>
<td><code>estimator</code></td>
<td>estimator</td>
<td>need to provide an initialized model for which to load the weights. The estimator can include a new config setup, changing <code>n_epochs</code> to keep training the model further.</td>
<td></td>
</tr>
<tr>
<td><code>load_saved_config</code></td>
<td>bool</td>
<td>updates config parameters from <code>{path}/params.json</code>.</td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pytorch model</td>
<td>loaded model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.CNN3dConfig</code><em><code>(n_epochs, patience, min_delta, logdir, lr, min_lr, *args, **kwargs)</code></em></p>
</div>
<dl>
<dd>Configuration for the CNN3d - based on pytorch and catalyst libraries</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_epochs</code></td>
<td>int</td>
<td>number of epochs</td>
<td>1</td>
</tr>
<tr>
<td><code>patience</code></td>
<td>int</td>
<td>number of epochs with no improvement after which training will be stopped. Default</td>
<td>10</td>
</tr>
<tr>
<td><code>min_delta</code></td>
<td>float</td>
<td>minimum change in the monitored metric to qualify as an improvement, i.e. an absolute change of less than min_delta, will count as no improvement</td>
<td>1e-5</td>
</tr>
<tr>
<td><code>log_dir</code></td>
<td>int</td>
<td>path to store the logs</td>
<td>./logs/</td>
</tr>
<tr>
<td><code>lr</code></td>
<td>float</td>
<td>learning rate</td>
<td>1e-3</td>
</tr>
<tr>
<td><code>min_lr</code></td>
<td>float</td>
<td>a lower bound of the learning rate  for <a href="https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.ReduceLROnPlateau.html">ReduceLROnPlateau</a></td>
<td>lr*1e-2</td>
</tr>
<tr>
<td><code>device</code></td>
<td>str</td>
<td>specify the device to run the model on</td>
<td>cuda (or switch to cpu)</td>
</tr>
<tr>
<td><nobr><code>loader_key</code></nobr></td>
<td>str</td>
<td>the loader to use for early stop: <em>train</em> or <em>valid</em></td>
<td>first loader provided*, which is usually 'train'</td>
</tr>
<tr>
<td><nobr><code>metric_key</code></nobr></td>
<td>str</td>
<td>the metric to use for early stop</td>
<td>'loss'</td>
</tr>
<tr>
<td><code>ddp</code></td>
<td>bool</td>
<td>turn on Distributed Data Parallel (DDP) in order to distribute the data and train the model across multiple GPUs.  This is passed to Catalyst to activate the <code>ddp</code> flag in <code>runner</code> (see more <a href="https://catalyst-team.github.io/catalyst/tutorials/ddp.html">Distributed Training Tutorial</a>; the <code>runner</code> is set up in <a href="https://github.com/pikarpov-LANL/Sapsan/blob/master/sapsan/lib/estimator/pytorch_estimator.py">pytorch_estimator.py</a>). <strong>Note: doesn't support jupyter notebooks - prepare a script!</strong></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="pimlturb"><abbr title="Physics-Informed Machine Learning for Turbulence">PIMLTurb</abbr></h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.PIMLTurb</code><em><code>(activ, loss, loaders, ks_stop, ks_frac, ks_scale, l1_scale, l1_beta, sigma, config, model)</code></em></p>
</div>
<dl>
<dd>Physics-informed machine learning model to predict Reynolds-like stress tensor, <span class="arithmatex">\(Re\)</span>, for turbulence modeling. Learn more on the wiki: <a href="/details/estimators/#physics-informed-cnn-for-turbulence-modeling-pimlturb"><abbr title="Physics-Informed Machine Learning for Turbulence">PIMLTurb</abbr></a></dd>
<dd>A custom loss function was developed for this model combining spatial (SmoothL1) and statistical (Kolmogorov-Smirnov) losses.</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>activ</code></td>
<td>str</td>
<td>activation function to use from PyTorch</td>
<td>Tanhshrink</td>
</tr>
<tr>
<td><code>loss</code></td>
<td>str</td>
<td>loss function to use; accepts only custom</td>
<td>SmoothL1_KSLoss</td>
</tr>
<tr>
<td><code>loaders</code></td>
<td>dict</td>
<td>contains input and target data (loaders['train'], loaders['valid']). Datasets themselves have to be torch.tensor(s)</td>
<td></td>
</tr>
<tr>
<td><code>ks_stop</code></td>
<td>float</td>
<td>early-stopping condition based on the <abbr title="Kolmogorov-Smirnov Statistic">KS</abbr> loss value alone</td>
<td>0.1</td>
</tr>
<tr>
<td><code>ks_frac</code></td>
<td>float</td>
<td>fraction the <abbr title="Kolmogorov-Smirnov Statistic">KS</abbr> loss contributes to the total loss</td>
<td>0.5</td>
</tr>
<tr>
<td><code>ks_scale</code></td>
<td>float</td>
<td>scale factor to prioritize <abbr title="Kolmogorov-Smirnov Statistic">KS</abbr> loss over SmoothL1 (should not be altered)</td>
<td>1</td>
</tr>
<tr>
<td><code>l1_scale</code></td>
<td>float</td>
<td>scale factor to prioritize SmoothL1 loss over <abbr title="Kolmogorov-Smirnov Statistic">KS</abbr></td>
<td>1</td>
</tr>
<tr>
<td><code>l1_beta</code></td>
<td>float</td>
<td><span class="arithmatex">\(beta\)</span> threshold for smoothing the L1 loss</td>
<td>1</td>
</tr>
<tr>
<td><code>sigma</code></td>
<td>float</td>
<td><span class="arithmatex">\(sigma\)</span> for the last layer of the network that performs a filtering operation using a Gaussian kernel</td>
<td>1</td>
</tr>
<tr>
<td><code>config</code></td>
<td>class</td>
<td>configuration to use for the model</td>
<td>PIMLTurbConfig()</td>
</tr>
<tr>
<td><code>model</code></td>
<td>class</td>
<td>the model itself - should not be adjusted</td>
<td>PIMLTurbModel()</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.PIMLTurb.save</code><em><code>(path: str)</code></em></p>
</div>
<dl>
<dd>Saves model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.PIMLTurb.load</code><em><code>(path: str, estimator, load_saved_config = False)</code></em></p>
</div>
<dl>
<dd>Loads model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
<tr>
<td><code>estimator</code></td>
<td>estimator</td>
<td>need to provide an initialized model for which to load the weights. The estimator can include a new config setup, changing <code>n_epochs</code> to keep training the model further.</td>
<td></td>
</tr>
<tr>
<td><code>load_saved_config</code></td>
<td>bool</td>
<td>updates config parameters from <code>{path}/params.json</code>.</td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pytorch model</td>
<td>loaded model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.PIMLTurbConfig</code><em><code>(n_epochs, patience, min_delta, logdir, lr, min_lr, *args, **kwargs)</code></em></p>
</div>
<dl>
<dd>Configuration for the <abbr title="Physics-Informed Machine Learning for Turbulence">PIMLTurb</abbr> - based on pytorch (catalyst is not used)</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_epochs</code></td>
<td>int</td>
<td>number of epochs</td>
<td>1</td>
</tr>
<tr>
<td><code>patience</code></td>
<td>int</td>
<td>number of epochs with no improvement after which training will be stopped <em>(not used)</em></td>
<td>10</td>
</tr>
<tr>
<td><code>min_delta</code></td>
<td>float</td>
<td>minimum change in the monitored metric to qualify as an improvement, i.e. an absolute change of less than min_delta, will count as no improvement <em>(not used)</em></td>
<td>1e-5</td>
</tr>
<tr>
<td><code>log_dir</code></td>
<td>int</td>
<td>path to store the logs</td>
<td>./logs/</td>
</tr>
<tr>
<td><code>lr</code></td>
<td>float</td>
<td>learning rate</td>
<td>1e-3</td>
</tr>
<tr>
<td><code>min_lr</code></td>
<td>float</td>
<td>a lower bound of the learning rate  for <a href="https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.ReduceLROnPlateau.html">ReduceLROnPlateau</a></td>
<td>lr*1e-2</td>
</tr>
<tr>
<td><code>device</code></td>
<td>str</td>
<td>specify the device to run the model on</td>
<td>cuda (or switch to cpu)</td>
</tr>
<tr>
<td><nobr><code>loader_key</code></nobr></td>
<td>str</td>
<td>the loader to use for early stop: <em>train</em> or <em>valid</em></td>
<td>first loader provided*, which is usually 'train'</td>
</tr>
<tr>
<td><nobr><code>metric_key</code></nobr></td>
<td>str</td>
<td>the metric to use for early stop</td>
<td>'loss'</td>
</tr>
<tr>
<td><code>ddp</code></td>
<td>bool</td>
<td>turn on Distributed Data Parallel (DDP) in order to distribute the data and train the model across multiple GPUs.  This is passed to Catalyst to activate the <code>ddp</code> flag in <code>runner</code> (see more <a href="https://catalyst-team.github.io/catalyst/tutorials/ddp.html">Distributed Training Tutorial</a>; the <code>runner</code> is set up in <a href="https://github.com/pikarpov-LANL/Sapsan/blob/master/sapsan/lib/estimator/pytorch_estimator.py">pytorch_estimator.py</a>). <strong>Note: doesn't support jupyter notebooks - prepare a script!</strong></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="picae"><abbr title="Physics-Informed Convolutional Autoencoder">PICAE</abbr></h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.PICAE</code><em><code>(loaders, config, model)</code></em></p>
</div>
<dl>
<dd>Convolutional Auto Encoder with Divergence-Free Kernel and with periodic padding. Further details can be found on the <a href="/details/estimators/#physics-informed-convolutional-autoencoder-picae"><abbr title="Physics-Informed Convolutional Autoencoder">PICAE</abbr> page</a></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>loaders</code></td>
<td>dict</td>
<td>contains input and target data (loaders['train'], loaders['valid']). Datasets themselves have to be torch.tensor(s)</td>
<td></td>
</tr>
<tr>
<td><code>config</code></td>
<td>class</td>
<td>configuration to use for the model</td>
<td>PICAEConfig()</td>
</tr>
<tr>
<td><code>model</code></td>
<td>class</td>
<td>the model itself - should not be adjusted</td>
<td>PICAEModel()</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.PICAE.save</code><em><code>(path: str)</code></em></p>
</div>
<dl>
<dd>Saves model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.PICAE.load</code><em><code>(path: str, estimator, load_saved_config = False)</code></em></p>
</div>
<dl>
<dd>Loads model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
<tr>
<td><code>estimator</code></td>
<td>estimator</td>
<td>need to provide an initialized model for which to load the weights. The estimator can include a new config setup, changing <code>n_epochs</code> to keep training the model further.</td>
<td></td>
</tr>
<tr>
<td><nobr><code>load_saved_config</code>&gt;</nobr></td>
<td>bool</td>
<td>updates config parameters from <code>{path}/params.json</code></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pytorch model</td>
<td>loaded model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.PICAEConfig</code><em><code>(n_epochs, patience, min_delta, logdir, lr, min_lr, weight_decay, nfilters, kernel_size, enc_nlayers, dec_nlayers, *args, **kwargs)</code></em></p>
</div>
<dl>
<dd>Configuration for the CNN3d - based on pytorch and catalyst libraries</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_epochs</code></td>
<td>int</td>
<td>number of epochs</td>
<td>1</td>
</tr>
<tr>
<td><code>batch_dim</code></td>
<td>int</td>
<td>dimension of a batch in each axis</td>
<td>64</td>
</tr>
<tr>
<td><code>patience</code></td>
<td>int</td>
<td>number of epochs with no improvement after which training will be stopped</td>
<td>10</td>
</tr>
<tr>
<td><code>min_delta</code></td>
<td>float</td>
<td>minimum change in the monitored metric to qualify as an improvement, i.e. an absolute change of less than min_delta, will count as no improvement</td>
<td>1e-5</td>
</tr>
<tr>
<td><code>log_dir</code></td>
<td>str</td>
<td>path to store the logs</td>
<td>./logs/</td>
</tr>
<tr>
<td><code>lr</code></td>
<td>float</td>
<td>learning rate</td>
<td>1e-3</td>
</tr>
<tr>
<td><code>min_lr</code></td>
<td>float</td>
<td>a lower bound of the learning rate  for <a href="https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.ReduceLROnPlateau.html">ReduceLROnPlateau</a></td>
<td>lr*1e-2</td>
</tr>
<tr>
<td><nobr><code>weight_decay</code></nobr></td>
<td>float</td>
<td>weight decay (L2 penalty)</td>
<td>1e-5</td>
</tr>
<tr>
<td><code>nfilters</code></td>
<td>int</td>
<td>the output dim for each convolutional layer, which is the number of "filters" learned by that layer</td>
<td>6</td>
</tr>
<tr>
<td><nobr><code>kernel_size</code></nobr></td>
<td>tuple</td>
<td>size of the convolutional kernel</td>
<td>(3,3,3)</td>
</tr>
<tr>
<td><code>enc_layers</code></td>
<td>int</td>
<td>number of encoding layers</td>
<td>3</td>
</tr>
<tr>
<td><code>dec_layers</code></td>
<td>int</td>
<td>number of decoding layers</td>
<td>3</td>
</tr>
<tr>
<td><code>device</code></td>
<td>str</td>
<td>specify the device to run the model on</td>
<td>cuda (or switch to cpu)</td>
</tr>
<tr>
<td><nobr><code>loader_key</code></nobr></td>
<td>str</td>
<td>the loader to use for early stop: <em>train</em> or <em>valid</em></td>
<td>first loader provided*, which is usually 'train'</td>
</tr>
<tr>
<td><nobr><code>metric_key</code></nobr></td>
<td>str</td>
<td>the metric to use for early stop</td>
<td>'loss'</td>
</tr>
<tr>
<td><code>ddp</code></td>
<td>bool</td>
<td>turn on Distributed Data Parallel (DDP) in order to distribute the data and train the model across multiple GPUs.  This is passed to Catalyst to activate the <code>ddp</code> flag in <code>runner</code> (see more <a href="https://catalyst-team.github.io/catalyst/tutorials/ddp.html">Distributed Training Tutorial</a>; the <code>runner</code> is set up in <a href="https://github.com/pikarpov-LANL/Sapsan/blob/master/sapsan/lib/estimator/pytorch_estimator.py">pytorch_estimator.py</a>). <strong>Note: doesn't support jupyter notebooks - prepare a script!</strong></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="krr"><abbr title="Kernel Ridge Regression">KRR</abbr></h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.KRR</code><em><code>(loaders, config, model)</code></em></p>
</div>
<dl>
<dd>A model based on sk-learn <a href="/details/estimators/#kernel-ridge-regression-krr">Kernel Ridge Regression</a></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>loaders</code></td>
<td>list</td>
<td>contains input and target data</td>
<td></td>
</tr>
<tr>
<td><code>config</code></td>
<td>class</td>
<td>configuration to use for the model</td>
<td>KRRConfig()</td>
</tr>
<tr>
<td><code>model</code></td>
<td>class</td>
<td>the model itself - should not be adjusted</td>
<td>KRRModel()</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.KRR.save</code><em><code>(path: str)</code></em></p>
</div>
<dl>
<dd>Saves the model</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.KRR.load</code><em><code>(path: str, estimator, load_saved_config = False)</code></em></p>
</div>
<dl>
<dd>Loads the model</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
<tr>
<td><code>estimator</code></td>
<td>estimator</td>
<td>need to provide an initialized model for which to load the weights. The estimator can include a new config setup, changing <code>n_epochs</code> to keep training the model further.</td>
<td></td>
</tr>
<tr>
<td><nobr><code>load_saved_config</code></nobr></td>
<td>bool</td>
<td>updates config parameters from <code>{path}/params.json</code></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sklearn model</td>
<td>loaded model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.KRRConfig</code><em><code>(alpha, gamma)</code></em></p>
</div>
<dl>
<dd>Configuration for the <abbr title="Kernel Ridge Regression">KRR</abbr> model</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alpha</code></td>
<td>float</td>
<td>regularization term, hyperparameter</td>
<td>None</td>
</tr>
<tr>
<td><code>gamma</code></td>
<td>float</td>
<td>full-width at half-max for the RBF kernel, hyperparameter</td>
<td>None</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="load_estimator">load_estimator</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.load_estimator</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Dummy estimator to call <code>load()</code> to load the saved pytorch models</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.load_estimator.load</code><em><code>(path: str, estimator, load_saved_config = False)</code></em></p>
</div>
<dl>
<dd>Loads model and optimizer states, as well as final epoch and loss</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
<tr>
<td><code>estimator</code></td>
<td>estimator</td>
<td>need to provide an initialized model for which to load the weights. The estimator can include a new config setup, changing <code>n_epochs</code> to keep training the model further</td>
<td></td>
</tr>
<tr>
<td><nobr><code>load_saved_config</code></nobr></td>
<td>bool</td>
<td>updates config parameters from <code>{path}/params.json</code></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pytorch model</td>
<td>loaded model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="load_sklearn_estimator">load_sklearn_estimator</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.load_sklearn_estimator</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Dummy estimator to call <code>load()</code> to load the saved sklearn models</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.load_sklearn_estimator.load</code><em><code>(path: str, estimator, load_saved_config = False)</code></em></p>
</div>
<dl>
<dd>Loads model</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>save path of the model and its config parameters, <code>{path}/model.pt</code> and <code>{path}/params.json</code> respectively</td>
<td></td>
</tr>
<tr>
<td><code>estimator</code></td>
<td>estimator</td>
<td>need to provide an initialized model for which to load the weights. The estimator can include a new config setup to keep training the model further</td>
<td></td>
</tr>
<tr>
<td><nobr><code>load_saved_config</code></nobr></td>
<td>bool</td>
<td>updates config parameters from <code>{path}/params.json</code></td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sklearn model</td>
<td>loaded model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="torch-modules">Torch Modules</h2>
<hr/>
<h3 id="gaussian">Gaussian</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.torch_modules.Gaussian</code><em><code>(sigma: int)</code></em></p>
</div>
<dl>
<dd>[3D] Applies a Guassian filter as a torch layer through a series of 3 separable 1D convolutions, utilizing <a href="https://pytorch.org/docs/stable/generated/torch.nn.Conv3d.html">torch.nn.funcitonal.conv3d</a>. CUDA is supported.</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sigma</code></td>
<td>int</td>
<td>standard deviation <span class="arithmatex">\(\sigma\)</span> for a Gaussian kernel</td>
<td>2</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.torch_modules.Gaussian.forward</code><em><code>(tensor: torch.tensor)</code></em></p>
</div>
<dl>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tensor</code></td>
<td>torch.tensor</td>
<td>input torch tensor of shape  [N, C<sub>in</sub>, D<sub>in</sub>, H<sub>in</sub>, W<sub>in</sub>]</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>torch.tensor</td>
<td>filtered 3D torch data</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="interp1d">Interp1d</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.estimator.torch_modules.Interp1d</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Linear 1D interpolation done in native PyTorch. CUDA is supported. Forked from <a href="https://github.com/aliutkus/torchinterp1d">@aliutkus</a></dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.estimator.torch_modules.Interp1d.forward</code><em><code>(x: torch.tensor, y: torch.tensor, xnew: torch.tensor, out: torch.tensor)</code></em></p>
</div>
<dl>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td>torch.tensor</td>
<td>1D or 2D tensor</td>
<td></td>
</tr>
<tr>
<td><code>y</code></td>
<td>torch.tensor</td>
<td>1D or 2D tensor; the length of <code>y</code> along its last dimension must be the same as that of <code>x</code></td>
<td></td>
</tr>
<tr>
<td><code>xnew</code></td>
<td>torch.tensor</td>
<td>1D or 2D tensor of real values. <code>xnew</code> can only be 1D if <ins>both</ins> <code>x</code> and <code>y</code> are 1D. Otherwise, its length along the first dimension must be the same as that of whichever <code>x</code> and <code>y</code> is 2D.</td>
<td></td>
</tr>
<tr>
<td><code>out</code></td>
<td>torch.tensor</td>
<td>Tensor for the output</td>
<td>If <em>None</em>, allocated automatically</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>torch.tensor</td>
<td>interpolated tensor</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="data-loaders">Data Loaders</h2>
<hr/>
<h3 id="hdf5dataset">HDF5Dataset</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.data.hdf5_dataset.HDF5Dataset</code><em><code>( path: str, features: List[str], target: List[str], checkpoints: List[int], batch_size: int = None, input_size: int = None, sampler: Optional[Sampling] = None, time_granularity: float = 1, features_label: Optional[List[str]] = None, target_label: Optional[List[str]] = None, flat: bool = False, shuffle: bool=False, train_fraction = None)</code></em></p>
</div>
<dl>
<dd>HDF5 data loader class</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>str</td>
<td>path to the data in the following format: <code>"data/t_{checkpoint:1.0f}/{feature}_data.h5"</code></td>
<td></td>
</tr>
<tr>
<td><code>features</code></td>
<td>List[str]</td>
<td>list of train features to load</td>
<td>['not_specified_data']</td>
</tr>
<tr>
<td><code>target</code></td>
<td>List[str]</td>
<td>list of target features to load</td>
<td>None</td>
</tr>
<tr>
<td><code>checkpoints</code></td>
<td>List[int]</td>
<td>list of checkpoints to load (they will be appended as batches)</td>
<td></td>
</tr>
<tr>
<td><nobr><code>input_size</code></nobr></td>
<td>int</td>
<td>dimension of the loaded data in each axis</td>
<td></td>
</tr>
<tr>
<td><nobr><code>batch_size</code></nobr></td>
<td>int</td>
<td>dimension of a batch in each axis. If batch_size != input_size, the datacube will be evenly splitted</td>
<td>input_size (doesn't work with <em>sampler</em>)</td>
</tr>
<tr>
<td><nobr><code>batch_num</code></nobr></td>
<td>int</td>
<td>the number of batches to be loaded at a time</td>
<td>1</td>
</tr>
<tr>
<td><code>sampler</code></td>
<td>object</td>
<td>data sampler to use (ex: EquidistantSampling())</td>
<td>None</td>
</tr>
<tr>
<td><nobr><code>time_granularity</code></nobr></td>
<td>float</td>
<td>what is the time separation (dt) between checkpoints</td>
<td>1</td>
</tr>
<tr>
<td><nobr><code>features_label</code></nobr></td>
<td>List[str]</td>
<td>hdf5 data label for the train features</td>
<td>list(file.keys())[-1], i.e. last one in hdf5 file</td>
</tr>
<tr>
<td><nobr><code>target_label</code></nobr></td>
<td>List[str]</td>
<td>hdf5 data label for the target features</td>
<td>list(file.keys())[-1], i.e. last one in hdf5 file</td>
</tr>
<tr>
<td><code>flat</code></td>
<td>bool</td>
<td>flatten the data into [C<sub>in</sub>, D*H*W]. Required for sk-learn models</td>
<td>False</td>
</tr>
<tr>
<td><code>shuffle</code></td>
<td>bool</td>
<td>shuffle the dataset</td>
<td>False</td>
</tr>
<tr>
<td><nobr><code>train_fraction</code></nobr></td>
<td>float or int</td>
<td>a fraction of the dataset to be used for training (accessed through loaders['train']). The rest will be used for validation (accessed through loaders['valid']). If <em>int</em> is provided, then that number of <em>batches</em> will be used for training. If <em>float</em> is provided, then it will try to split the data either by batch or by actually slicing the data cube into smaller chunks</td>
<td>None - training data will be used for validation, effectively skipping the latter</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.data.hdf5_dataset.HDF5Dataset.load_numpy()</code></p>
</div>
<dl>
<dd>HDF5 data loader method - call it to load the data as a numpy array. If <em>targets</em> are not specified, than only features will be loaded (hence you can just load 1 dataset at a time).</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray, np.ndarray</td>
<td>loaded a dataset as a numpy array</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.data.hdf5_dataset.HDF5Dataset.convert_to_torch([x, y])</code></p>
</div>
<dl>
<dd>Splits numpy arrays into batches and converts to torch dataloader</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[x, y]</code></td>
<td>list or np.ndarray</td>
<td>a list of input datasets to batch and convert to torch loaders</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OrderedDict{'train' : DataLoader, 'valid' : DataLoader }</td>
<td>Data in Torch Dataloader format ready for training</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.data.hdf5_dataset.HDF5Dataset.load()</code></p>
</div>
<dl>
<dd>Loads, splits into batches, and converts into torch dataloader. Effectively combines .load_numpy and .convert_to_torch</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray, np.ndarray</td>
<td>loaded train and target features: x, y</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="get_loader_shape">get_loader_shape</h3>
<div class="admonition code">
<p><code>sapsan.lib.data.data_functions.get_loader_shape()</code></p>
</div>
<dl>
<dd>Returns the shape of the loaded tensors - the loaded data that has been split into <code>train</code> and <code>valid</code> datasets.</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>loaders</code></td>
<td>torch DataLoader</td>
<td>the loader of tensors passed for training</td>
<td></td>
</tr>
<tr>
<td><code>name</code></td>
<td>str</td>
<td>name of the dataset in the loaders; usually either <code>train</code> or <code>valid</code></td>
<td>None - chooses the first entry in loaders</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>shape of the tensor</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="data-manipulation">Data Manipulation</h2>
<hr/>
<h3 id="equidistantsampling">EquidistantSampling</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.data.sampling.EquidistantSampling</code><em><code>(target_dim)</code></em></p>
</div>
<dl>
<dd>Samples the data to a lower dimension, keeping separation between the data points equally distant</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><nobr><code>target_dim</code></nobr></td>
<td>np.ndarray</td>
<td>new shape of the input in the form [D, H, W]</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.data.sampling.EquidistantSampling.sample</code><em><code>(data)</code></em></p>
</div>
<dl>
<dd>Performs sampling of the data</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data</code></td>
<td>np.ndarray</td>
<td>input data to be sampled - has the shape of [axis, D, H, W]</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>Sampled data with the shape [axis, D, H, W]</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="split_data_by_batch">split_data_by_batch</h3>
<div class="admonition code">
<p><code>sapsan.utils.shapes.split_data_by_batch</code><em><code>(data: np.ndarray, size: int, batch_size: int, n_features: int, axis: int)</code></em></p>
</div>
<dl>
<dd>[2D, 3D]: splits data into smaller cubes or squares of batches</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data</code></td>
<td>np.ndarray</td>
<td>input 2D or 3D data, [C<sub>in</sub>, D, H, W]</td>
<td></td>
</tr>
<tr>
<td><code>size</code></td>
<td>int</td>
<td>dimensionality of the data in each axis</td>
<td></td>
</tr>
<tr>
<td><nobr><code>batch_size</code></nobr></td>
<td>int</td>
<td>dimensionality of the batch in each axis</td>
<td></td>
</tr>
<tr>
<td><nobr><code>n_features</code></nobr></td>
<td>int</td>
<td>number of channels of the input data</td>
<td></td>
</tr>
<tr>
<td><code>axis</code></td>
<td>int</td>
<td>number of axes, 2 or 3</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>batched data: [N, C<sub>in</sub>, D<sub>b</sub>, H<sub>b</sub>, W<sub>b</sub>]</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="combine_data">combine_data</h3>
<div class="admonition code">
<p><code>sapsan.utils.shapes.combine_data</code><em><code>(data: np.ndarray, input_size: tuple, batch_size: tuple, axis: int)</code></em></p>
</div>
<dl>
<dd>[2D, 3D] - reverse of <code>split_data_by_batch</code> function</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data</code></td>
<td>np.ndarray</td>
<td>input 2D or 3D data, [N, C<sub>in</sub>, D<sub>b</sub>, H<sub>b</sub>, W<sub>b</sub>]</td>
<td></td>
</tr>
<tr>
<td><nobr><code>input_size</code></nobr></td>
<td>tuple</td>
<td>dimensionality of the original data in each axis</td>
<td></td>
</tr>
<tr>
<td><nobr><code>batch_size</code></nobr></td>
<td>tuple</td>
<td>dimensionality of the batch in each axis</td>
<td></td>
</tr>
<tr>
<td><code>axis</code></td>
<td>int</td>
<td>number of axes, 2 or 3</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>reassembled data: [C<sub>in</sub>, D, H, W]</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="slice_of_cube">slice_of_cube</h3>
<div class="admonition code">
<p><code>sapsan.utils.shapes.slice_of_cube</code><em><code>(data: np.ndarray, feature: Optional[int] = None, n_slice: Optional[int] = None)</code></em></p>
</div>
<dl>
<dd>Select a slice of a cube (to plot later)</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data</code></td>
<td>np.ndarray</td>
<td>input 3D data, [C<sub>in</sub>, D, H, W]</td>
<td></td>
</tr>
<tr>
<td><code>feature</code></td>
<td>int</td>
<td>feature to take the slice of, i.e. the value of C<sub>in</sub></td>
<td>1</td>
</tr>
<tr>
<td><code>n_slice</code></td>
<td>int</td>
<td>what slice to select, i.e. the value of D</td>
<td>1</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>data slice: [H, W]</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="filter">Filter</h2>
<hr/>
<h3 id="spectral">spectral</h3>
<div class="admonition code">
<p><code>sapsan.utils.filter.spectral</code><em><code>(im: np.ndarray, fm: int)</code></em></p>
</div>
<dl>
<dd>[2D, 3D] apply a spectral filter</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>im</code></td>
<td>np.ndarray</td>
<td>input dataset (ex: [C<sub>in</sub>, D, H, W])</td>
<td></td>
</tr>
<tr>
<td><code>fm</code></td>
<td>int</td>
<td>number of Fourier modes to filter down to</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>filtered dataset</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="box">box</h3>
<div class="admonition code">
<p><code>sapsan.utils.filter.box</code><em><code>(im: np.ndarray, ksize)</code></em></p>
</div>
<dl>
<dd>[2D] apply a <a href="https://docs.opencv.org/2.4/modules/imgproc/doc/filtering.html#boxfilter">box filter</a></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>im</code></td>
<td>np.ndarray</td>
<td>input dataset (ex: [C<sub>in</sub>, H, W])</td>
<td></td>
</tr>
<tr>
<td><code>ksize</code></td>
<td>tupple</td>
<td>kernel size (ex: ksize = (2,2))</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>filtered dataset</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="gaussian_1">gaussian</h3>
<div class="admonition code">
<p><code>sapsan.utils.filter.gaussian</code><em><code>(im: np.ndarray, sigma)</code></em></p>
</div>
<dl>
<dd>[2D, 3D] apply a <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.gaussian_filter.html">gaussian filter</a></dd>
<dd>Note: Guassian filter assumes dx=1 between the points. Adjust sigma accordingly.</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>im</code></td>
<td>np.ndarray</td>
<td>input dataset (ex: [H, W] or [D, H, W])</td>
<td></td>
</tr>
<tr>
<td><code>sigma</code></td>
<td>float or tuple of floats</td>
<td>standard deviation for Gaussian kernel. Sigma can be defined for each axis individually.</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>filtered dataset</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="backend-tracking">Backend (Tracking)</h2>
<hr/>
<h3 id="mlflowbackend">MLflowBackend</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.backends.mlflow.MLflowBackend</code><em><code>(name, host, port)</code></em></p>
</div>
<dl>
<dd>Initilizes <a href="https://www.mlflow.org/">mlflow</a> and starts up <a href="https://www.mlflow.org/docs/latest/tracking.html#tracking-ui">mlflow ui</a> at a given host:port</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>str</td>
<td>name under which to record the experiment</td>
<td>"experiment"</td>
</tr>
<tr>
<td><code>host</code></td>
<td>str</td>
<td>host of mlflow ui</td>
<td>"localhost"</td>
</tr>
<tr>
<td><code>port</code></td>
<td>int</td>
<td>port of mlflow ui</td>
<td>9000</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.start_ui</code><em><code>()</code></em></p>
</div>
<dl>
<dd>starts MLflow ui at a specified host and port</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.start</code><em><code>(run_name: str, nested = False, run_id = None)</code></em></p>
</div>
<dl>
<dd>Starts a tracking run</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>run_name</code></td>
<td>str</td>
<td>name of the run</td>
<td>"train" for <code>Train()</code>, "evaluate" for <code>Evaluate()</code></td>
</tr>
<tr>
<td><code>nested</code></td>
<td>bool</td>
<td>whether or not to nest the recorded run</td>
<td><em>False</em> for <code>Train()</code>, <em>True</em> for <code>Evaluate()</code></td>
</tr>
<tr>
<td><code>run_id</code></td>
<td>str</td>
<td>run id</td>
<td>None - a new will be generated</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>str</td>
<td>run_id</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.resume</code><em><code>(run_id, nested = True)</code></em></p>
</div>
<dl>
<dd>Resumes a previous run, so you can record extra parameters</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>run_id</code></td>
<td>str</td>
<td>id of the run to resume</td>
<td></td>
</tr>
<tr>
<td><code>nested</code></td>
<td>bool</td>
<td>whether or not to nest the recorded run</td>
<td>True, since it will usually be an <code>Evaluate()</code> run</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.log_metric</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Logs a metric</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.log_parameter</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Logs a parameter</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.log_artifact</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Logs an artifact (any saved file such, e.g. .png, .txt)</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.close_active_run</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Closes all active MLflow runs</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.lib.backends.mlflow.MLflowBackend.end</code><em><code>()</code></em></p>
</div>
<dl>
<dd>Ends the most recent MLflow run</dd>
</dl>
<hr/>
<h3 id="fakebackend">FakeBackend</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.lib.backends.fake.FakeBackend()</code></p>
</div>
<dl>
<dd>Pass to <code>train</code> in order to disable backend (tracking)</dd>
</dl>
<h2 id="plotting">Plotting</h2>
<hr/>
<h3 id="plot_params">plot_params</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.plot_params()</code></p>
</div>
<dl>
<dd>Contains the matplotlib parameters that format all of the plots (<code>font.size</code>, <code>axes.labelsize</code>, etc.)</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dict</td>
<td>matplotlib parameters</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<details class="cite">
<summary>Default Parameters</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">plot_params</span><span class="p">():</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'font.size'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">'legend.fontsize'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> 
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>            <span class="s1">'axes.labelsize'</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">'axes.titlesize'</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>            <span class="s1">'xtick.labelsize'</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span><span class="s1">'ytick.labelsize'</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>            <span class="s1">'axes.linewidth'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'patch.linewidth'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> 
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>            <span class="s1">'lines.linewidth'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>            <span class="s1">'xtick.major.width'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span><span class="s1">'ytick.major.width'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>            <span class="s1">'xtick.minor.width'</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span><span class="s1">'ytick.minor.width'</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>            <span class="s1">'xtick.major.size'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span><span class="s1">'ytick.major.size'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>            <span class="s1">'xtick.minor.size'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span><span class="s1">'ytick.minor.size'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>            <span class="s1">'xtick.direction'</span><span class="p">:</span> <span class="s1">'in'</span><span class="p">,</span><span class="s1">'ytick.direction'</span><span class="p">:</span> <span class="s1">'in'</span><span class="p">,</span>              
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>            <span class="s1">'axes.formatter.limits'</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span><span class="s1">'axes.grid'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>            <span class="s1">'grid.linestyle'</span><span class="p">:</span> <span class="s1">':'</span><span class="p">,</span><span class="s1">'grid.color'</span><span class="p">:</span> <span class="s1">'#999999'</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>            <span class="s1">'text.usetex'</span><span class="p">:</span> <span class="kc">False</span><span class="p">,}</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
</details>
</dd>
</dl>
<hr/>
<h3 id="pdf_plot">pdf_plot</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.pdf_plot</code><em><code>(series: List[np.ndarray], bins: int = 100, label: Optional[List[str]] = None, figsize: tuple, dpi: int, ax: matplotlib.axes, style: str)</code></em></p>
</div>
<dl>
<dd>Plot a probability density function (PDF) of a single or multiple datasets</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>series</code></td>
<td>List[np.ndarray]</td>
<td>input datasets</td>
<td></td>
</tr>
<tr>
<td><code>bins</code></td>
<td>int</td>
<td>number of bins to use for the dataset to generate the pdf</td>
<td>100</td>
</tr>
<tr>
<td><code>label</code></td>
<td>List[str]</td>
<td>list of names to use as labels in the legend</td>
<td>None</td>
</tr>
<tr>
<td><code>figsize</code></td>
<td>tuple</td>
<td>figure size as passed to matplotlib figure</td>
<td>(6,6)</td>
</tr>
<tr>
<td><code>dpi</code></td>
<td>int</td>
<td>resolution of the figure</td>
<td>60</td>
</tr>
<tr>
<td><code>ax</code></td>
<td>matplotlib.axes</td>
<td>axes object to use for plotting (if you want to define your own figure and subplots)</td>
<td>None - creates a separate figure</td>
</tr>
<tr>
<td><code>style</code></td>
<td>str</td>
<td>accepts <a href="https://matplotlib.org/stable/gallery/style_sheets/style_sheets_reference.html">matplotlib styles</a></td>
<td>'tableau-colorblind10'</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>matplotlib.axes object</td>
<td>ax</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="cdf_plot">cdf_plot</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.cdf_plot</code><em><code>(series: List[np.ndarray], bins: int = 100, label: Optional[List[str]] = None, figsize: tuple, dpi: int, ax: matplotlib.axes, ks: bool, style: str)</code></em></p>
</div>
<dl>
<dd>Plot a cumulative distribution function (CDF) of a single or multiple datasets</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>series</code></td>
<td>List[np.ndarray]</td>
<td>input datasets</td>
<td></td>
</tr>
<tr>
<td><code>bins</code></td>
<td>int</td>
<td>number of bins to use for the dataset to generate the pdf</td>
<td>100</td>
</tr>
<tr>
<td><code>label</code></td>
<td>List[str]</td>
<td>list of names to use as labels in the legend</td>
<td>None</td>
</tr>
<tr>
<td><code>figsize</code></td>
<td>tuple</td>
<td>figure size as passed to matplotlib figure</td>
<td>(6,6)</td>
</tr>
<tr>
<td><code>dpi</code></td>
<td>int</td>
<td>resolution of the figure</td>
<td>60</td>
</tr>
<tr>
<td><code>ax</code></td>
<td>matplotlib.axes</td>
<td>axes object to use for plotting (if you want to define your own figure and subplots)</td>
<td>None - creates a separate figure</td>
</tr>
<tr>
<td><code>ks</code></td>
<td>bool</td>
<td>if <em>True</em> prints out on the plot itself the <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test">Kolomogorov-Smirnov Statistic</a>. It will also be returned along with the <em>ax</em> object</td>
<td>False</td>
</tr>
<tr>
<td><code>style</code></td>
<td>str</td>
<td>accepts <a href="https://matplotlib.org/stable/gallery/style_sheets/style_sheets_reference.html">matplotlib styles</a></td>
<td>'tableau-colorblind10'</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>matplotlib.axes object, float (if ks==True)</td>
<td>ax, ks (if ks==True)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="line_plot">line_plot</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.line_plot</code><em><code>(series: List[np.ndarray], bins: int = 100, label: Optional[List[str]] = None, plot_type: str, figsize: tuple, dpi: int, ax: matplotlib.axes, style: str)</code></em></p>
</div>
<dl>
<dd>Plot linear data of x vs y - same matplotlib formatting will be used as the other plots</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>series</code></td>
<td>List[np.ndarray]</td>
<td>input datasets</td>
<td></td>
</tr>
<tr>
<td><code>bins</code></td>
<td>int</td>
<td>number of bins to use for the dataset to generate the pdf</td>
<td>100</td>
</tr>
<tr>
<td><code>label</code></td>
<td>List[str]</td>
<td>list of names to use as labels in the legend</td>
<td>None</td>
</tr>
<tr>
<td><code>plot_type</code></td>
<td>str</td>
<td>axis type of the matplotlib plot; options = ['plot', 'semilogx', 'semilogy', 'loglog']</td>
<td>'plot'</td>
</tr>
<tr>
<td><code>figsize</code></td>
<td>tuple</td>
<td>figure size as passed to matplotlib figure</td>
<td>(6,6)</td>
</tr>
<tr>
<td><code>linestyle</code></td>
<td>List[str]</td>
<td>list of linestyles to use for each profile for the matplotlib figure</td>
<td>['-'] (solid line)</td>
</tr>
<tr>
<td><code>dpi</code></td>
<td>int</td>
<td>resolution of the figure</td>
<td>60</td>
</tr>
<tr>
<td><code>ax</code></td>
<td>matplotlib.axes</td>
<td>axes object to use for plotting (if you want to define your own figure and subplots)</td>
<td>None - creates a separate figure</td>
</tr>
<tr>
<td><code>style</code></td>
<td>str</td>
<td>accepts <a href="https://matplotlib.org/stable/gallery/style_sheets/style_sheets_reference.html">matplotlib styles</a></td>
<td>'tableau-colorblind10'</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>matplotlib.axes object</td>
<td>ax</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="slice_plot">slice_plot</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.slice_plot</code><em><code>(series: List[np.ndarray], label: Optional[List[str]] = None, cmap = 'plasma', figsize: tuple, dpi: int, ax: matplotlib.axes)</code></em></p>
</div>
<dl>
<dd>Plot 2D spatial distributions (slices) of your target and prediction datasets</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>series</code></td>
<td>List[np.ndarray]</td>
<td>input datasets</td>
<td></td>
</tr>
<tr>
<td><code>label</code></td>
<td>List[str]</td>
<td>list of names to use as labels in the legend</td>
<td>None</td>
</tr>
<tr>
<td><code>cmap</code></td>
<td>str</td>
<td>matplotlib colormap to use</td>
<td>'plasma'</td>
</tr>
<tr>
<td><code>figsize</code></td>
<td>tuple</td>
<td>figure size as passed to matplotlib figure</td>
<td>(6,6)</td>
</tr>
<tr>
<td><code>dpi</code></td>
<td>int</td>
<td>resolution of the figure</td>
<td>60</td>
</tr>
<tr>
<td><code>ax</code></td>
<td>matplotlib.axes</td>
<td>axes object to use for plotting (if you want to define your own figure and subplots) <br/> <mark class="critic">WARNING: only works if a <ins>single</ins> image is supplied to <code>slice_plot()</code>, otherwise will be ignored</mark></td>
<td>None - creates a separate figure</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>matplotlib.axes object</td>
<td>ax</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="log_plot">log_plot</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.log_plot</code><em><code>(show_log = True, log_path = 'logs/logs/train.csv', valid_log_path = 'logs/logs/valid.csv', delimiter=',', train_name = 'train_loss', valid_name = 'valid_loss', train_column = 1, valid_column = 1, epoch_column = 0)</code></em></p>
</div>
<dl>
<dd>Plots an interactive training log of train_loss vs. epoch with plotly</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>show_log</code></td>
<td>bool</td>
<td>show the loss vs. epoch progress plot (it will be save in mlflow in either case)</td>
<td>True</td>
</tr>
<tr>
<td><code>log_path</code></td>
<td>str</td>
<td>path to training log produced by the catalyst wrapper</td>
<td>'logs/logs/train.csv'</td>
</tr>
<tr>
<td><nobr><code>valid_log_path</code></nobr></td>
<td>str</td>
<td>path to validation log produced by the catalyst wrapper</td>
<td>'logs/logs/valid.csv'</td>
</tr>
<tr>
<td><code>delimiter</code></td>
<td>str</td>
<td>delimiter to use for numpy.genfromtxt data loading</td>
<td>','</td>
</tr>
<tr>
<td><code>train_name</code></td>
<td>str</td>
<td>name for the training label</td>
<td>'train_loss'</td>
</tr>
<tr>
<td><code>valid_name</code></td>
<td>str</td>
<td>name for the validation label</td>
<td>'valid_loss'</td>
</tr>
<tr>
<td><code>train_column</code></td>
<td>int</td>
<td>column to load for training data from <code>log_path</code></td>
<td>1</td>
</tr>
<tr>
<td><code>valid_column</code></td>
<td>int</td>
<td>column to load for validation data from <code>valid_log_path</code></td>
<td>1</td>
</tr>
<tr>
<td><code>epoch_column</code></td>
<td>int</td>
<td>column to load the epoch index from <code>log_path</code>. If <em>None</em>, then epoch will be generated fro the number of entries</td>
<td>0</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>plotly.express object</td>
<td>plot figure</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="model_graph">model_graph</h3>
<div class="admonition code">
<p><code>sapsan.utils.plot.model_graph</code><em><code>(model, shape: np.array, transforms)</code></em></p>
</div>
<dl>
<dd>Creates a graph of the ML model (needs graphviz to be installed). A tutorial is available on the wiki: <a href="/tutorials/model_graph/">Model Graph</a></dd>
<dd>The method is based on <a href="https://github.com/waleedka/hiddenlayer">hiddenlayer</a> originally written by Waleed Abdulla.</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td>object</td>
<td>initialized pytorch or tensorflow model</td>
<td></td>
</tr>
<tr>
<td><code>shape</code></td>
<td>np.array</td>
<td>shape of the input array in the form [N, C<sub>in</sub>, D<sub>b</sub>, H<sub>b</sub>, W<sub>b</sub>], where C<sub>in</sub>=1</td>
<td></td>
</tr>
<tr>
<td><nobr><code>transforms</code></nobr></td>
<td>list[methods]</td>
<td>a list of hiddenlayer transforms to be applied (<em>Fold, FoldId, Prune, PruneBranch, FoldDuplicates, Rename</em>)</td>
<td><nobr><em>See below</em> <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.5 14.5 16 20l-5.5-5.5 1.41-1.41L15 16.17V10.5C15 8 13 6 10.5 6H4V4h6.5a6.5 6.5 0 0 1 6.5 6.5v5.67l3.09-3.09 1.41 1.42Z"></path></svg></span></nobr></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<details class="cite">
<summary>Default Parameters</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">sapsan.utils.hiddenlayer</span> <span class="k">as</span> <span class="nn">hl</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Fold</span><span class="p">(</span><span class="s2">"Conv &gt; MaxPool &gt; Relu"</span><span class="p">,</span> <span class="s2">"ConvPoolRelu"</span><span class="p">),</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Fold</span><span class="p">(</span><span class="s2">"Conv &gt; MaxPool"</span><span class="p">,</span> <span class="s2">"ConvPool"</span><span class="p">),</span>    
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Prune</span><span class="p">(</span><span class="s2">"Shape"</span><span class="p">),</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Prune</span><span class="p">(</span><span class="s2">"Constant"</span><span class="p">),</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Prune</span><span class="p">(</span><span class="s2">"Gather"</span><span class="p">),</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Prune</span><span class="p">(</span><span class="s2">"Unsqueeze"</span><span class="p">),</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Prune</span><span class="p">(</span><span class="s2">"Concat"</span><span class="p">),</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Rename</span><span class="p">(</span><span class="s2">"Cast"</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">"Input"</span><span class="p">),</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>                <span class="n">hl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">FoldDuplicates</span><span class="p">()</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>            <span class="p">]</span>
</code></pre></div></td></tr></table></div>
</details>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>graphviz.Digraph object</td>
<td>graph of a model</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="physics">Physics</h2>
<hr/>
<h3 id="reynoldsstress">ReynoldsStress</h3>
<div class="admonition code">
<p><code>sapsan.utils.physics.ReynoldsStress</code><em><code>(u, filt, filt_size, only_x_components=False)</code></em></p>
</div>
<dl>
<dd>Calculates a stress tensor of the form </dd>
</dl>
<div class="arithmatex">\[
\tau_{ij} = \widetilde{u_i u_j} - \tilde{u}_i\tilde{u}_j
\]</div>
<dl>
<dd>where <span class="arithmatex">\(\tilde{u}\)</span> is the filtered <span class="arithmatex">\(u\)</span></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>u</code></td>
<td>np.ndarray</td>
<td>input velocity in 3D - [axis, D, H, W]</td>
<td></td>
</tr>
<tr>
<td><code>filt</code></td>
<td>sapsan.utils.filters</td>
<td>the type of filter to use (spectral, box, gaussian). Pass the filter itself by loading the appropriate one from <code>sapsan.utils.filters</code></td>
<td>gaussian</td>
</tr>
<tr>
<td><code>filt_size</code></td>
<td>int or float</td>
<td>size of the filter to apply. For different filter types, the size is defined differently. Spectral - fourier mode to filter to, Box - k_size (box size), Gaussian - sigma</td>
<td>2 (sigma=2 for gaussian)</td>
</tr>
<tr>
<td><nobr><code>only_x_component</code></nobr></td>
<td>bool</td>
<td>calculates and outputs only x components of the tensor in shape [row, D, H, W] - calculating all 9 can be taxing on memory</td>
<td>False</td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>stress tensor of shape [column, row, D, H, W]</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="powerspectrum">PowerSpectrum</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.utils.physics.PowerSpectrum</code><em><code>(u: np.ndarray)</code></em></p>
</div>
<dl>
<dd>Sets up to produce a power spectrum</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>u</code></td>
<td>np.ndarray</td>
<td>input velocity in 3D - [axis, D, H, W]</td>
<td></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.utils.physics.PowerSpectrum.calculate()</code></p>
</div>
<dl>
<dd>Calculates the power spectrum</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray, np.ndarray</td>
<td>k_bins (fourier modes), Ek_bins (E(k))</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.utils.physics.PowerSpectrum.spectrum_plot</code><em><code>(k_bins, Ek_bins, kolmogorov=True, kl_a)</code></em></p>
</div>
<dl>
<dd>Plots the calculated power spectrum</dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>k_bins</code></td>
<td>np.ndarray</td>
<td>fourier mode values along x-axis</td>
<td></td>
</tr>
<tr>
<td><code>Ek_bins</code></td>
<td>np.ndarray</td>
<td>energy as a function of k: E(k)</td>
<td></td>
</tr>
<tr>
<td><code>kolmogorov</code></td>
<td>bool</td>
<td>plots scaled Kolmogorov's -5/3 spectrum alongside the calculated one</td>
<td>True</td>
</tr>
<tr>
<td><code>kl_A</code></td>
<td>float</td>
<td>scaling factor of Kolmogorov's law</td>
<td><em>np.amax(self.Ek_bins)*1e1</em></td>
</tr>
</tbody>
</table>
</dd>
<dd>
<div class="admonition code">
<p>Return</p>
</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>matplotlib.axes object</td>
<td>spectrum plot</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="gradientmodel">GradientModel</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.utils.physics.GradientModel</code><em><code>(u: np.ndarray, filter_width, delta_u = 1)</code></em></p>
</div>
<dl>
<dd>sets up to apply a gradient turbulence subgrid model: </dd>
</dl>
<div class="arithmatex">\[
\tau_{ij} = \frac{1}{12} \Delta^2 \,\delta_k u^*_i \,\delta_k u^*_j
\]</div>
<dl>
<dd>where <span class="arithmatex">\(\Delta\)</span> is the filter width and <span class="arithmatex">\(u^*\)</span> is the filtered <span class="arithmatex">\(u\)</span></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>u</code></td>
<td>np.ndarray</td>
<td>input <strong>filtered</strong> quantity in 3D - [axis, D, H, W]</td>
<td></td>
</tr>
<tr>
<td><nobr><code>filter_width</code></nobr></td>
<td>float</td>
<td>width of the filter which was applied onto <code>u</code></td>
<td></td>
</tr>
<tr>
<td><code>delta_u</code></td>
<td></td>
<td>distance between the points on the grid to use for scaling</td>
<td>1</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.utils.physics.GradientModel.gradient()</code></p>
</div>
<dl>
<dd>calculated the gradient of the given input data from GradientModel</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>gradient with shape [column, row, D, H, W]</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.utils.physics.GradientModel.model()</code></p>
</div>
<dl>
<dd>calculates the gradient model tensor with shape [column, row, D, H, W]</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>gradient model tensor</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<hr/>
<h3 id="dynamicsmagorinskymodel">DynamicSmagorinskyModel</h3>
<div class="admonition code">
<p><span style="color:var(--class-color)">CLASS</span></p>
<p><code>sapsan.utils.physics.DynamicSmagorinskyModel</code><em><code>(u: np.ndarray, filt, original_filt_size, filt_ratio, du, delta_u)</code></em></p>
</div>
<dl>
<dd>sets up to apply a Dynamic Smagorinsky (DS) turbulence subgrid model: </dd>
</dl>
<div class="arithmatex">\[
\tau_{ij} = -2(C_s\Delta^*)^2|S^*|S^*_{ij}
\]</div>
<dl>
<dd>where <span class="arithmatex">\(\Delta\)</span> is the filter width and <span class="arithmatex">\(S^*\)</span> is the filtered <span class="arithmatex">\(u\)</span></dd>
<dd>
<div class="admonition code">Parameters</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Discription</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>u</code></td>
<td>np.ndarray</td>
<td>input <strong>filtered</strong> quantity either in 3D [axis, D, H, W] or 2D [axis, D, H]</td>
<td></td>
</tr>
<tr>
<td><code>du</code></td>
<td>np.ndarray</td>
<td>gradient of <code>u</code></td>
<td>None*: if <code>du</code> is not provided, then it will be calculated with <code>np.gradient()</code></td>
</tr>
<tr>
<td><code>filt</code></td>
<td>sapsan.utils.filters</td>
<td>the type of filter to use (spectral, box, gaussian). Pass the filter itself by loading the appropriate one from <code>sapsan.utils.filters</code></td>
<td>spectral</td>
</tr>
<tr>
<td><nobr><code>original_fil_size</code></nobr></td>
<td>int</td>
<td>width of the filter which was applied onto <code>u</code></td>
<td>15 (spectral, fourier modes = 15)</td>
</tr>
<tr>
<td><code>delta_u</code></td>
<td>float</td>
<td>distance between the points on the grid to use for scaling</td>
<td>1</td>
</tr>
<tr>
<td><code>filt_ratio</code></td>
<td>float</td>
<td>the ratio of additional filter that will be applied on the data to find the slope for Dynamic Smagorinsky extrapolation over <code>original_filt_size</code></td>
<td>0.5</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition code">
<p><code>sapsan.utils.physics.DynamicSmagorinskyModel.model()</code></p>
</div>
<dl>
<dd>calculates the DS model tensor with shape [column, row, D, H, W]</dd>
<dd>
<div class="admonition code">Return</div>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>np.ndarray</td>
<td>DS model tensor</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Community Guidelines" class="md-footer__link md-footer__link--prev" href="../other/community/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Community Guidelines
            </div>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2019 - 2022 Tried National Security (Los Alamos National Laboratory), BSD
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/pikarpov-LANL" rel="noopener" target="_blank" title="Platon Karpov on GitHub">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/in/pikarpov/" rel="noopener" target="_blank" title="Platon Karpov on LinkedIn">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["content.tooltips", "navigation.instant", "navigation.tracking", "navigation.sections", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "search.highlight", "search.suggest", "search.share", "header.autohide", "content.code.annotate"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
<script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
<script src="../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "width": "100%", "height": "auto", "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body>
</html>